<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="IDBFS : IndexedDB file system" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>IDBFS</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/js-platform/idbfs">View on GitHub</a>

          <h1 id="project_title">IDBFS</h1>
          <h2 id="project_tagline">IndexedDB file system</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/js-platform/idbfs/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/js-platform/idbfs/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>IDBFS is provides a POSIX-like file system interface for browser-based JavaScript.</p>

<ul>
<li><a href="https://raw.github.com/js-platform/idbfs/develop/dist/idbfs.js">idbfs.js</a></li>
<li><a href="https://raw.github.com/js-platform/idbfs/develop/dist/idbfs.min.js">idbfs.min.js</a></li>
</ul><h3>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h3>

<p>The best way to get started is to read through the <code>Getting Started</code> and <code>Example</code> sections before having a look through the open <a href="https://github.com/js-platform/idbfs/issues">issues</a>. Some of the issues are marked as <code>good first bug</code>, but feel free to contribute to any of the issues there, or open a new one if the thing you want to work on isn't there yet. If you would like to have an issue assigned to you, please send me a message and I'll update it.</p>

<p>Once you've done some hacking and you'd like to have your work merged, you'll need to make a pull request. If you're patch includes code, make sure to check that all the unit tests pass, including any new tests you wrote. Finally, make sure you add yourself to the <code>AUTHORS</code> file.</p>

<h3>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting Started</h3>

<p>IDBFS is partly based on the <code>fs</code> module from node.js. The API is asynchronous and most methods require the caller to provide a callback function. Errors are passed to callbacks through the first parameter.</p>

<p>To create a new file system or open an existing one, create a new <code>FileSystem</code> instance and pass the name of the file system. A new IndexedDB database is created for each file system.</p>

<p>For additional documentation, check out the <code>API Reference</code> below and have a look through the unit tests for more concrete examples of how things work.</p>

<h4>
<a name="example" class="anchor" href="#example"><span class="octicon octicon-link"></span></a>Example</h4>

<pre><code>&lt;script&gt;
  var fs = new IDBFS.FileSystem('local');
  fs.open('/myfile', 'w+', function(err, fd) {
    if (err) throw err;
    fs.close(fd, function(err) {
      if (err) throw err;
      fs.stat('/myfile', function(err, stats) {
        if (err) throw err;
        console.log('stats: ' + JSON.stringify(stats));
      });
    });
  });
&lt;/script&gt;
</code></pre>

<p>As with node.js, there is no guarantee that file system operations will be executed in the order they are invoked. Ensure proper ordering by chaining operations in callbacks.</p>

<h3>
<a name="tests" class="anchor" href="#tests"><span class="octicon octicon-link"></span></a>Tests</h3>

<p>You can run the tests from the project by opening the <code>tests</code> directory in your browser. You can also run them <a href="http://js-platform.github.io/idbfs/tests/">here</a>.</p>

<h3>
<a name="api-reference" class="anchor" href="#api-reference"><span class="octicon octicon-link"></span></a>API Reference</h3>

<p>Callbacks for methods that accept them are non-optional. The first callback parameter is reserved for passing errors. It will be <code>undefined</code> if no errors occurred and should always be checked.</p>

<h4>
<a name="idbfsfilesystemname-flags" class="anchor" href="#idbfsfilesystemname-flags"><span class="octicon octicon-link"></span></a>IDBFS.FileSystem(name, flags)</h4>

<p>File system constructor, invoked to open an existing file system or create a new one. Accepts a name and optional flags. Use <code>'FORMAT'</code> to force IDBFS for format the file system.</p>

<h4>
<a name="fsstatpath-callback" class="anchor" href="#fsstatpath-callback"><span class="octicon octicon-link"></span></a>fs.stat(path, callback)</h4>

<p>Asynchronous stat(2). Callback gets <code>(error, stats)</code>, where <code>stats</code> is an object like</p>

<pre><code>    {
      node: &lt;string&gt; // internal node id (unique)
      dev: &lt;string&gt; // file system name
      size: &lt;number&gt; // file size in bytes
      nlinks: &lt;number&gt; // number of links
      atime: &lt;number&gt; // last access time
      mtime: &lt;number&gt; // last modified time
      ctime: &lt;number&gt; // creation time
      type: &lt;string&gt; // file type (FILE, DIRECTORY, ...)
    }
</code></pre>

<h4>
<a name="fsfstatfd-callback" class="anchor" href="#fsfstatfd-callback"><span class="octicon octicon-link"></span></a>fs.fstat(fd, callback)</h4>

<p>Asynchronous stat(2). Callback gets <code>(error, stats)</code>. See <code>fs.stat</code>.</p>

<h4>
<a name="fslinksrcpath-dstpath-callback" class="anchor" href="#fslinksrcpath-dstpath-callback"><span class="octicon octicon-link"></span></a>fs.link(srcPath, dstPath, callback)</h4>

<p>Asynchronous link(2). Callback gets no additional arguments.</p>

<h4>
<a name="fsunlinkpath-callback" class="anchor" href="#fsunlinkpath-callback"><span class="octicon octicon-link"></span></a>fs.unlink(path, callback)</h4>

<p>Asynchronous unlink(2). Callback gets no additional arguments.</p>

<h4>
<a name="fsrenameoldpath-newpath-callback" class="anchor" href="#fsrenameoldpath-newpath-callback"><span class="octicon octicon-link"></span></a>fs.rename(oldPath, newPath, callback)</h4>

<p>Asynchronous rename(2). Callback gets no additional arguments.</p>

<h4>
<a name="fsrmdirpath-callback" class="anchor" href="#fsrmdirpath-callback"><span class="octicon octicon-link"></span></a>fs.rmdir(path, callback)</h4>

<p>Asynchronous rmdir(2). Callback gets no additional arguments.</p>

<h4>
<a name="fsmkdirpath-callback" class="anchor" href="#fsmkdirpath-callback"><span class="octicon octicon-link"></span></a>fs.mkdir(path, callback)</h4>

<p>Asynchronous mkdir(2). Callback gets no additional arguments.</p>

<h4>
<a name="fsclosefd-callback" class="anchor" href="#fsclosefd-callback"><span class="octicon octicon-link"></span></a>fs.close(fd, callback)</h4>

<p>Asynchronous close(2). Callback gets no additional arguments.</p>

<h4>
<a name="fsopenpath-flags-callback" class="anchor" href="#fsopenpath-flags-callback"><span class="octicon octicon-link"></span></a>fs.open(path, flags, callback)</h4>

<p>Asynchronous open(2). Flags can be</p>

<ul>
<li>
<code>'r'</code>: Open file for reading. An exception occurs if the file does not exist.</li>
<li>
<code>'r+'</code>: Open file for reading and writing. An exception occurs if the file does not exist.</li>
<li>
<code>'w'</code>: Open file for writing. The file is created (if it does not exist) or truncated (if it exists).</li>
<li>
<code>'w+'</code>: Open file for reading and writing. The file is created (if it does not exist) or truncated (if it exists).</li>
<li>
<code>'a'</code>: Open file for appending. The file is created if it does not exist.</li>
<li>
<code>'a+'</code>: Open file for reading and appending. The file is created if it does not exist.</li>
</ul><p>Callback gets <code>(error, fd)</code>, where <code>fd</code> is the file descriptor.</p>

<p>Unlike node.js, IDBFS does not accept the optional <code>mode</code> parameter since it doesn't yet implement file permissions.</p>

<h4>
<a name="fswritefd-buffer-offset-length-position-callback" class="anchor" href="#fswritefd-buffer-offset-length-position-callback"><span class="octicon octicon-link"></span></a>fs.write(fd, buffer, offset, length, position, callback)</h4>

<p>Write bytes from <code>buffer</code> to the file specified by <code>fd</code>, where <code>offset</code> and <code>length</code> describe the part of the buffer to be written. The <code>position</code> refers to the offset from the beginning of the file where this data should be written. If <code>position</code> is <code>null</code>, the data will be written at the current position. See pwrite(2).</p>

<p>The callback gets <code>(error, nbytes)</code>, where <code>nbytes</code> is the number of bytes written.</p>

<h4>
<a name="fswritefilefilename-data-options-callback" class="anchor" href="#fswritefilefilename-data-options-callback"><span class="octicon octicon-link"></span></a>fs.writeFile(filename, data, [options], callback)</h4>

<p>Asynchronously writes data to a file. <code>data</code> can be a string or a buffer, in which case any encoding option is ignored. The <code>options</code> argument is optional, and can take the form <code>"utf8"</code> (i.e., an encoding) or be an object literal: <code>{ encoding: "utf8", flag: "w" }</code>. If no encoding is specified, and <code>data</code> is a string, the encoding defaults to <code>'utf8'</code>.  The callback gets <code>(error)</code>.</p>

<div class="highlight highlight-javascript"><pre><span class="c1">// Write UTF8 text file</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">(</span><span class="s1">'/myfile.txt'</span><span class="p">,</span> <span class="s2">"...data..."</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
<span class="p">});</span>

<span class="c1">// Write binary file</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">(</span><span class="s1">'/myfile'</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<h4>
<a name="fsreadfd-buffer-offset-length-position-callback" class="anchor" href="#fsreadfd-buffer-offset-length-position-callback"><span class="octicon octicon-link"></span></a>fs.read(fd, buffer, offset, length, position, callback)</h4>

<p>Read bytes from the file specified by <code>fd</code> into <code>buffer</code>, where <code>offset</code> and <code>length</code> describe the part of the buffer to be used. The <code>position</code> refers to the offset from the beginning of the file where this data should be read. If <code>position</code> is <code>null</code>, the data will be written at the current position. See pread(2).</p>

<p>The callback gets <code>(error, nbytes)</code>, where <code>nbytes</code> is the number of bytes read.</p>

<h4>
<a name="fsreadfilefilename-options-callback" class="anchor" href="#fsreadfilefilename-options-callback"><span class="octicon octicon-link"></span></a>fs.readFile(filename, [options], callback)</h4>

<p>Asynchronously reads the entire contents of a file. The <code>options</code> argument is optional, and can take the form <code>"utf8"</code> (i.e., an encoding) or be an object literal: <code>{ encoding: "utf8", flag: "r" }</code>. If no encoding is specified, the raw binary buffer is returned on the callback. The callback gets <code>(error, data)</code>, where data is the contents of the file.</p>

<div class="highlight highlight-javascript"><pre><span class="c1">// Read UTF8 text file</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">'/myfile.txt'</span><span class="p">,</span> <span class="s1">'utf8'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Read binary file</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">'/myfile.txt'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<h4>
<a name="fslseekfd-offset-whence-callback" class="anchor" href="#fslseekfd-offset-whence-callback"><span class="octicon octicon-link"></span></a>fs.lseek(fd, offset, whence, callback)</h4>

<p>Asynchronous lseek(2), where <code>whence</code> can be <code>SET</code>, <code>CUR</code>, or <code>END</code>. Callback gets <code>(error, pos)</code>, where <code>pos</code> is the resulting offset, in bytes, from the beginning of the file.</p>

<h4>
<a name="fsreaddirpath-callback" class="anchor" href="#fsreaddirpath-callback"><span class="octicon octicon-link"></span></a>fs.readdir(path, callback)</h4>

<p>Asynchronous readdir(3). Reads the contents of a directory. Callback gets <code>(error, files)</code>, where <code>files</code> is an array containing the names of each file in the directory, excluding <code>.</code> and <code>..</code>.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">IDBFS maintained by <a href="https://github.com/js-platform">js-platform</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-45767870-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
